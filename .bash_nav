# alias to run sublime text from anywhere
# alias subl='"/mnt/c/Program Files/Sublime Text 3/sublime_text.exe"'

if [ -d '/mnt/c/Windows' ]; then

    # alias cmd for calling the windows command line from bash
    alias cmd='/mnt/c/Windows/System32/cmd.exe /C'

    # open a file or dir using the default application on windows
    open() {
        /mnt/c/Windows/explorer.exe `wslpath -w "$@"`
    }

    # mount a remote drive over ssh in WSL2
    # arg 1: the hostname of the server, as specified in your ssh config
    sshopen() {
        ssh -q "$1" exit >/dev/null || return
        trap "cd \"$PWD\" && { fusermount -u \"$1\"; rmdir \"$1\"; }" EXIT && mkdir -p "$1" && {
            if [ -z "$(ls -A "$1")" ]; then
                sshfs -o allow_other,reconnect,ServerAliveInterval=15,ServerAliveCountMax=3,cache_timeout=3600,follow_symlinks "$1": "$1"
            fi
        } || {
            # if the sshfs command didn't work, store the exit code, clean up the dir and the trap, and then return the exit code
            local exit_code=$?
            rmdir "$1" && trap - EXIT
            return $exit_code
        }
        cd "$1"
    }

fi

# Source the base file for whatever shell you're running.
src() {
	# get basename of default shell in case the shell exec file is not in /bin
	local shll="$(basename -- "$SHELL")"
	if [ "$shll" = "bash" ] || [ "$shll" = "zsh" ] && [ -f "$HOME/.${shll}rc" ]; then
		. "$HOME/.${shll}rc" && echo "~/.${shll}rc sourced."
	else
		echo "Could not source; this shell is not supported."
	fi
}
